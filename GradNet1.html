<!DOCTYPE html>
<html lang="en">


    <title>Bootstrap Example</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
    <script rel="text/javascript" src ="select.js"></script>

    <!-- <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
     <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>-->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
    <!-- <script src="jquery-3.3.1.min.js"></script>
     <!-- JQuery Core JavaScript -->
    <!-- <script src="lib/js/jquery.min.js"></script>

     <!-- Bootstrap Core JavaScript -->
    <!-- <script src="lib/js/bootstrap.min.js"></script>-->

    <script src = "GradNet1.js"></script>
    <style>
        body {}

        .grid-container {
            display: grid;
            grid-template: auto auto auto auto;
            grid-gap: 10px;
            padding: 10px;
        }

        .grid-container>div {
            text-align: left;
            padding: 10px 0;
            font-size: 30px;
            justify-content: space-between;
            overflow: auto;
            width: 400px;
            height: 300px;
        }

        .grid-container1 {
            display: grid;
            grid-template: auto auto auto auto;
            grid-gap: 10px;
            padding: 10px;
        }

        .grid-container1>div {
            text-align: center;
            padding: 10px 0;
            font-size: 10px;
            justify-content: space-between;
            width: 80%;
            height: 35%px;
            border: .3px solid black;
        }

        h3 {
            text-align: center;
        }

        .center {
            display: block;
            margin-left: auto;
            margin-right: auto;
            width: 50%;
            height: 60%;
            width: 80%;
        }

         .candidate {
             background-color: white;
             padding: 20px;
             margin-top: 20px;
             text-align: center;
         }

                .APPLICANT:after {
                    content: "";
                    display: table;
                    clear: both;
                }




               #Interviews {
                   display: none; /* Hidden by default */
                   position: fixed; /* Stay in place */
                   z-index: 1; /* Sit on top */
                   left: 0;
                   top: 0;
                   width: 100%; /* Full width */
                   height: 100%; /* Full height */
                   overflow: auto; /* Enable scroll if needed */
                   background-color: rgb(0, 0, 0); /* Fallback color */
                   background-color: rgba(0, 0, 0, 0.4); /* Black w/ opacity */
                   padding-top: 60px;
               }
        




                   #Interviews-content{
                   	text-align: center;
                       vertical-align: middle;
                   	 position: relative;
                       background-color: #fefefe;
                       margin:  5% auto 15% auto;
                       padding: 0;
                       border: 1px solid #888;
                       width: 80%;
                       box-shadow: 0 4px 8px 0 rgba(0,0,0,0.2),0 6px 20px 0 rgba(0,0,0,0.19);
                       -webkit-animation-name: animatetop;
                       -webkit-animation-duration: 0.4s;
                       animation-name: animatetop;
                       animation-duration: 0.4s
                   }









    </style>
</head>

<body>
<div class="container">
    <h2>GradNet</h2>
    <select id="custom-select">
        <option value="level">Select level:</option>
        <option value="level">Level</option>
        <option value="Level 7">Level 7</option>
        <option value="Undergraduate in progress">Undergraduate Level 8 in progress</option>
        <option value="Undergraduate complete">UndergraduateLevel 8 complete</option>
        <option value="Higher Diploma">Higher Diploma</option>
        <option value="Masters">Masters</option>
        <option value="PhD">PhD</option>
    </select>
    <select id="custom-select">
        <option value="degree">Select Degree:</option>
        <option value="Accounting">Accounting</option>
        <option value="Anthropology">Anthropology</option>
        <option value="Aeronautical/Aerospace">Aeronautical/Aerospace</option>
        <option value="Agriculture">Agricultural Science</option>
        <option value="Architectural Science">Architecture</option>
        <option value="Biology">Biology</option>
        <option value="Biotechnology">Biotechnology</option>
        <option value="Chemistry">Chemistry</option>
        <option value="Communications">Communications</option>
        <option value="Computer Science">Computer Science</option>
        <option value="Construction">Construction</option>
        <option value="Customer Service Management">Customer Service Management</option>
        <option value="Education">Education</option>
        <option value="Engineering">Engineering</option>
        <option value="Environmental Studies">Environmental Studies</option>
        <option value="English">English</option>
        <option value="Finance">Finance</option>
        <option value="French">French</option>
        <option value="Healthcare">Healthcare</option>
        <option value="Hospitality">Hospitality</option>
        <option value="Human Resoure Management">Human Resoure Management</option>
        <option value="German">German</option>
        <option value="IT">IT</option>
        <option value="Legal">Legal</option>
        <option value="Linguistics">Linguistics</option>
        <option value="Manufacturing Engineering ">Manufacture Engineering</option>
        <option value="Marketing">Marketing</option>
        <option value="Mechanical Engineering">Mechanical Engineering</option>
        <option value="Mechanical Engineering">Mechanical Engineering</option>
        <option value="Operations/Logistics">Operations/Logistics</option>
        <option value="Physics">Physics</option>
        <option value="Physics and Mathemathics">Physics and Mathemathics</option>
        <option value="Project Management">Project Management </option>
        <option value="Science">Science</option>
        <option value="Sociology">Sociology</option>
        <option value="Social Work">Social Work</option>
        <option value="Sports Science">Sports Science</option>
        <option value="Spanish">Spanish</option>
        <option value="Web Development">Web Development</option>
    </select>
    <select id="custom-select">
        <option value="postgraduate">Select Postgraduate:</option>
        <option value="Accounting">Accounting</option>
        <option value="Anthropology">Anthropology</option>
        <option value="Aeronautical/Aerospace">Aeronautical/Aerospace</option>
        <option value="Agriculture">Agricultural Science</option>
        <option value="Architectural Science">Architecture</option>
        <option value="Biology">Biology</option>
        <option value="Biotechnology">Biotechnology</option>
        <option value="Chemistry">Chemistry</option>
        <option value="Communications">Communications</option>
        <option value="Computer Science">Computer Science</option>
        <option value="Construction">Construction</option>
        <option value="Customer Service Management">Customer Service Management</option>
        <option value="Education">Education</option>
        <option value="Engineering">Engineering</option>
        <option value="Environmental Studies">Environmental Studies</option>
        <option value="English">English</option>
        <option value="Finance">Finance</option>
        <option value="French">French</option>
        <option value="Healthcare">Healthcare</option>
        <option value="Hospitality">Hospitality</option>
        <option value="Human Resoure Management">Human Resoure Management</option>
        <option value="German">German</option>
        <option value="IT">IT</option>
        <option value="Legal">Legal</option>
        <option value="Linguistics">Linguistics</option>
        <option value="Manufacturing Engineering ">Manufacture Engineering</option>
        <option value="Marketing">Marketing</option>
        <option value="Mechanical Engineering">Mechanical Engineering</option>
        <option value="Mechanical Engineering">Mechanical Engineering</option>
        <option value="Operations/Logistics">Operations/Logistics</option>
        <option value="Physics">Physics</option>
        <option value="Physics and Mathemathics">Physics and Mathemathics</option>
        <option value="Project Management">Project Management </option>
        <option value="Science">Science</option>
        <option value="Sociology">Sociology</option>
        <option value="Social Work">Social Work</option>
        <option value="Sports Science">Sports Science</option>
        <option value="Spanish">Spanish</option>
        <option value="Web Development">Web Development</option>
    </select>
               <button style = "visibility:visible" id = "logoutbtn" onclick="signout()" class = "logout">Log Out</button>
    <ul class="nav nav-tabs">
        <li class="active"><a href="#home">Home</a></li>
        <li><a href="#menu1">Overview</a></li>
        <li><a href="#menu2">Jobs</a></li>
        <li><a href="#menu3">Candidates</a></li>
    </ul>
    <div class="tab-content" contenteditable="true">
        <div id="home" class="tab-pane fade in active">
            <div class="grid-container1">
                <div id="comp-details"class="w3-container">
                    <div ><h1 id="item1"></h1></div>
                    <div id="item2"></div>
                    <div id="item3"></div>
                    <div id="item4"></div>
                    <div id="item5"></div>
                    <div id="item6"></div>
                    <div id="item7"></div>
                </div>
                <div class="w3-container">
                    <p id="job-blurb"contenteditable="true"></p>
                     <p id="ideal-candidate"contenteditable="true"></p>
                </div>
                <div class="w3-container">
                    <h2>Company Review</h2>
                </div>
            </div>
        </div>
        <div id="menu1" class="tab-pane fade">
            <h3>Applications</h3>
       <!--    <table id="bodytable" class="table" width="500" style="border:1px solid #333" cellpadding="20" cellspacing="0" height="100%" width="100%">

                <tr>
                    <td align="center" valign="top"></td>
                </tr>
                <Tr>
                    <td align="center" valign="top">
                        <table id="emailConatiner" align="center" width="600" border="0" cellspacing="0" cellpadding="20" style="border:1px solid #ccc;">
                            <tr>
                                this is where header content goes.
                                <td>data info</td>
                                <td></td>
                            </tr>
                        </table>-->
            <div id="APPLICANT" >

            </div>



                    </td>
                </tr>
                <tr>
                   <!-- <td align="center" valign="top">
                        <table border="0" cellpadding="20" cellspacing="20" width="100%" id="emailBody">
                            <tr>
                                <td align="center" valign="top">
                                    This is where my body content goes.
                                </td>
                            </tr>
                        </table>-->
                    </td>
                </tr>
                <tr>
                    <td align="center" valign="top">
                       <!-- <table border="0" cellpadding="20" cellspacing="0" width="100%" id="emailFooter">
                            <tr>
                                <td align="center" valign="top">
                                    This is where my footer content goes.
                                </td>
                            </tr>
                        </table>-->
                    </td>
                </tr>
            </table>
            </td>
            </tr>
            </table>
        </div>
        <div id="menu2" class="tab-pane fade">
            <h1>Post a Job</h1>
            <div class="grid-container">
                <form action="">
               <!-- <form action="/action_page.php">-->
                    <div class="row">
                        <div class="col-25">
                            <label for="cname">Company Name</label>
                        </div>
                        <div class="col-75">
                            <input type="text" id="cname" name="cname" placeholder="Company Name..">
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-25">
                            <label for="jtitle">Job Title</label>
                        </div>
                        <div class="col-75">
                            <input type="text" id="jtitle" name="jobtitle" placeholder="Job Title..">
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-25">
                            <label for="subject">Job Description</label>
                        </div>
                        <div class="col-75">
                            <textarea id="subject" name="subject" placeholder="Write something.." style="height:200px"></textarea>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-25">
                            <label for="city">City or County</label>
                        </div>
                        <div class="col-75">
                            <select id="city" name="city">
                                <option value="dublin">Dublin</option>
                                <option value="kildare">Kildare</option>
                                <option value="meath">Meath</option>
                            </select>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-25">
                            <label for="jtype">Job Type (optional)</label>
                        </div>
                        <div class="col-75">
                            <input type="text" id="jtype" name="jtype" placeholder="...">
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-25">
                            <label for="salary">Salary (optional) €</label>
                        </div>
                        <div class="col-75">
                            <input type="text" id="salary" name="salary" placeholder="24k a year...">
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-25">
                            <label for="exp">Experience</label>
                        </div>
                        <div class="col-75">
                            <input type="text" id="exp" name="exp" placeholder="Example:Accounting">
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-25">
                            <label for="licence">Licence (optional)</label>
                        </div>
                        <div class="col-75">
                            <input type="text" id="licence" name="licence" placeholder="Example: Driver Licence">
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-25">
                            <label for="elevel">Education level (optional)</label>
                        </div>
                        <div class="col-75">
                            <select id="elevel">
                                <option value="level">Level</option>
                                <option value="Level 7">Level 7</option>
                                <option value="Undergraduate in progress">Undergraduate Level 8 in progress</option>
                                <option value="Undergraduate complete">UndergraduateLevel 8 complete</option>
                                <option value="Higher Diploma">Higher Diploma</option>
                                <option value="Masters">Masters</option>
                                <option value="PhD">PhD</option>
                            </select>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-25">
                            <label for="language">Additional language required (optional)</label>
                        </div>
                        <div class="col-75">
                            <input type="text" id="language" name="language" placeholder="Example: German">
                        </div>
                    </div>
                    <div class="row">
                        <button onClick="post();">Submit</button>
                    </div>
                </form>
            </div>
        </div>
        <div id="menu3" class="tab-pane fade"  >
            <h1>Interviews</h1>

        </div>
        <div id="Interviews">
            <div id="Interviews-content">
                           <span onclick="document.getElementById('Interviews').style.display='none'" class="eclose" title="Close Modal">&times;</span>
            <h1 id="TITLE"> </h1>
            <h3 id="Appid"></h3>
                <div>
            Schedule Interview Date
                    <br>
                   <input type="text" id="date-interview" name="cname" placeholder="dd/mm/yyyy ">
                </div>
                <div>
                     <textarea id="message-to-candidate" name="subject" placeholder="Write a message to candidate......" style="height:200px"></textarea>
                </div>
                               <button style = "visibility:visible" id = "submitbtn" onclick="submit()" class = "logout">Submit</button>
        </div>
        </div>
    </div>
    <script>
        $(document).ready(function() {
            $(".nav-tabs a").click(function() {
                $(this).tab('show');
            });
            $('.nav-tabs a').on('shown.bs.tab', function(event) {
                var x = $(event.target).text(); // active tab
                var y = $(event.relatedTarget).text(); // previous tab
                $(".act span").text(x);
                $(".prev span").text(y);
            });
        });

        function readURL(input) {
            if (input.files && input.files[0]) {
                var reader = new FileReader();
                reader.onload = function(e) {
                    $('#blah')
                        .attr('src', e.target.result)
                        .width(150)
                        .height(150);
                };
                reader.readAsDataURL(input.files[0]);
            }
        }

    </script>

    <script src="https://www.gstatic.com/firebasejs/4.12.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/4.12.0/firebase-auth.js"></script>
    <script src="https://www.gstatic.com/firebasejs/4.12.0/firebase-database.js"></script>
    <script src="https://www.gstatic.com/firebasejs/4.12.0/firebase-firestore.js"></script>
    <script src="https://www.gstatic.com/firebasejs/4.12.0/firebase-messaging.js"></script>
    <script src="https://www.gstatic.com/firebasejs/4.12.0/firebase-functions.js"></script>
    <script src="https://www.gstatic.com/firebasejs/4.12.0/firebase.js"></script>
    <script src="https://www.gstatic.com/firebasejs/4.12.0/firebase.js"></script>
    <script>
        // Initialize Firebase
        var config = {
            apiKey: "AIzaSyD4J4mmvmV5L34gmX9BL09ZMRHKD25D13w",
            authDomain: "project2-84c6e.firebaseapp.com",
            databaseURL: "https://project2-84c6e.firebaseio.com",
            projectId: "project2-84c6e",
            storageBucket: "project2-84c6e.appspot.com",
            messagingSenderId: "697844001483"
        };
        firebase.initializeApp(config);
        var database = firebase.database();
    </script>

    <script>
 var user1;
        firebase.auth().onAuthStateChanged(function(user) {
            if (user){

                console.log(user.uid);
                
                displayEmployer(user);
                showContent4(user);
                user1=user.uid;
                // User is signed in.
            } else {
                // No user is signed in.
                console.log("ERROR!!!!!!!!!!!!!!!");
            }
        });

 function displayEmployer(user) {
     var query = firebase.database().ref("Employer");

     query.once("value")
         .then(function (snapshot) {
             var Employer = snapshot.child(user.uid).child("empname").val();
             var EmpEmail = snapshot.child(user.uid).child("empemail").val();
             EmpEmail=       EmpEmail.replace(",", ".");
                    EmpEmail= EmpEmail.replace("(", "@");

             var Industry = snapshot.child(user.uid).child("Industry").val();
             var Address1 = snapshot.child(user.uid).child("Address1").val();
             var Address2 = snapshot.child(user.uid).child("Address2").val();
             var Address3 = snapshot.child(user.uid).child("Address3").val();
             var Country = snapshot.child(user.uid).child("country").val();
               var About=snapshot.child(user.uid).child("Blurb").val();
               var Ideal=snapshot.child(user.uid).child("IdealCand").val();

               


             document.getElementById("item1").innerHTML = Employer;
             document.getElementById("item2").innerHTML = "Email:" + EmpEmail;
             document.getElementById("item3").innerHTML = "Industry:" + Industry;
             document.getElementById("item4").innerHTML = Address1;
             document.getElementById("item5").innerHTML = Address2;
             document.getElementById("item6").innerHTML = Address3;
             document.createElement("item7").innerHTML = Country;

                        document.getElementById("job-blurb").innerHTML = About;
                          document.getElementById("ideal-candidate").innerHTML = Ideal;
         });
 }

function showContent4(user){
                       var num=1;
    var query2 = firebase.database().ref("Applications"); //.orderByKey();
    query2.on("value", function(snapshot) {
        snapshot.forEach(function(childSnapshot) {

            var childData = childSnapshot.val();
           /** getData("Jobs",childData.Job, function (d) {
                console.log(d.employer);       **/
                //console.log(user.uid);
                                 var key = childSnapshot.key;
                if(childData.EmpID===user.uid){

                              var MyID=document.createElement("div");
                       MyID.classList.add("MyID");
                        MyID.innerHTML=num;

                    var candidate= document.createElement("div");
                    candidate.classList.add("candidate");
                             candidate.setAttribute("id",num);

                    var AppID=document.createElement("div");
                     AppID.classList.add("AppID")  ;

                     AppID.innerHTML= key ;


                    var position= document.createElement("div");
                    position.classList.add("position");
                    position.innerHTML= "Position Applied for:"+childData.JobTitle;

                    var Name= document.createElement("div");
                    Name.classList.add("Name");

                    var College= document.createElement("div");
                     College.classList.add("College");

                    var Degree= document.createElement("div");
                    Degree.classList.add("Degree");

                    var PostDeg= document.createElement("div");
                    PostDeg.classList.add("PostDeg");

                    var Level= document.createElement("div");
                    Level.classList.add("Level");

                    var Blurb= document.createElement("div");
                        Blurb.classList.add("Blurb");

                    var Hobbies= document.createElement("div");
                    Hobbies.classList.add("Hobbies");

                    var Buttons=document.createElement("div");
                    Buttons.classList.add("Buttons");


                    var Accept=document.createElement("button");
                    Accept.classList.add("Accept");

                    Accept.onclick=function(){
                        accept(candidate.id );
                    } ;
                    Accept.innerHTML="Accept";


                    var Reject=document.createElement("button");
                    Reject.classList.add("Reject");
                    Reject.onclick=function(){
                        reject(candidate.id);
                    }
                    Reject.innerHTML="Reject";



                    getData2("users",childData.Applicant, function (d) {

                        Name.innerHTML= "Name of Candidate:"+d.fname;
                        College.innerHTML="College:"+d.college;
                        Level.innerHTML="Level:"+d.level;
                        Degree.innerHTML="Degree:"+d.degree;
                        PostDeg.innerHTML="Postgraduate Degree:"+d.postdoc;
                        Blurb.innerHTML= d.Blurb;
                        Hobbies.innerHTML="Candidates Hobbies are:"+d.Hobbies;
                        position.innerHTML= "Position Applied for:"+ childData.Jobtitle;

                    });
                          candidate.appendChild(MyID)
                        candidate.appendChild(position);
                    candidate.appendChild(Name);
                    candidate.appendChild(College);
                    candidate.appendChild(Degree);
                    candidate.appendChild(PostDeg);
                    candidate.appendChild(Level);
                    candidate.appendChild(Blurb);
                    candidate.appendChild(Hobbies);
                     candidate.appendChild(AppID);

                    Buttons.appendChild(Accept);
                    Buttons.appendChild(Reject);
                    candidate.appendChild(Buttons);


                    APPLICANT.appendChild(candidate);
                                    num=num+1;
                             }





        });
        });
}

 function getData(dataType, dataID,callback){
     var data = {};
     var dataRef = firebase.database().ref("/" + dataType + "/" + dataID );
     dataRef.on('value', function(snapshot) {
         snapshot.forEach(function(childSnapshot) {
             data[childSnapshot.key] = childSnapshot.val();
         });
         callback(data);
     });

     console.log(data);
     return data;
 }


 function getData2(dataType, dataID,callback){
     var data = {};
     var dataRef = firebase.database().ref("/" + dataType + "/" + dataID );
     dataRef.on('value', function(snapshot) {
         snapshot.forEach(function(childSnapshot) {
             data[childSnapshot.key] = childSnapshot.val();



         });
         callback(data);
     });

     console.log(data);
     return data;
 }




 function accept(id){
             document.getElementById("Interviews").style.display='block';
              var x=  document.getElementById(id);
      console.log(x);
              console.log(x.childNodes[2].innerHTML);
                           var y=x.childNodes[2].innerHTML
                 //   var x= document.getElementById("TITLE").innerHTML= Name;
                               var Name2 =y.slice(18);
                                   console.log(Name2);
                                      document.getElementById("TITLE").innerHTML= Name2;
                                        document.getElementById("Appid").innerHTML=x.childNodes[9].innerHTML;


 }




 function  submit(){
       var status="Accepted" ;
     var date= document.getElementById("date-interview").value;
        var message=  document.getElementById("message-to-candidate").value;
         var x=   document.getElementById("Appid");
         console.log(x.innerHTML);
         var x2=x.innerHTML;
                     writeUserData(x2,date, message, status);
                   alert("Applicant has been notified.")   ;    
              document.getElementById('Interviews').style.display='none'
 }

           function writeUserData(userId, date, message, status) {
           /**  firebase.database().ref('Applications/'+userId).set({
               Interview:date,

             });
                   firebase.database().ref('Applications/' + userId).set({
                     Status:status+message ,

               });**/

           var ref=firebase.database().ref("Applications")
               ref.child(userId).update({ InterView: date });
               ref.child(userId).update({Status: status+" "+message });



                    };



 function  reject(id){
     var x=  document.getElementById(id);
   var  y=x.childNodes[9].innerHTML;
     var ref=firebase.database().ref("Applications");

    ref.child(y).remove();


 }







              function signout() {
                  firebase.auth().signOut().then(function () {
                      console.log('Signed Out');
                      window.location.href = "Home.html";
                  }, function (error) {
                      console.error('Sign Out Error', error);
                  });
              }

              </script>

</body>

</html>